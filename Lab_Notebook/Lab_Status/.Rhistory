library(dada2)
path = "Reads/"
fnFS = sort(list.files(path, pattern = "_L001_R1_001.fastq"))
fnRs = sort(list.files(path, pattern = "_L001_R2_001.fastq"))
samp_names = sapply(strsplit(fnFS, "_"), `[`,2)
fnFS = file.path(path, fnFS)
fnRs = file.path(path, fnRs)
#plotQualityProfile(fnFS[7])
plotQualityProfile(fnRs)
#plotQualityProfile(fnFS[7])
plotQualityProfile(fnRs[2])
filt_path = file.path(path, "filtered")
filtFs = file.path(filt_path, paste0(samp_names, "F_filt.fastq.gz"))
filtRs = file.path(filt_path, paste0(samp_names, "R_filt.fastq.gz"))
out = filterAndTrim(fnFS, filtFs, fnRs, filtRs, truncLen = c(280, 279), maxN = 0, truncQ = 2, rm.phix = TRUE,compress = TRUE,multithread = TRUE)
head(out)
errF = learnErrors(filtFs, multithread = TRUE)
errR = learnErrors(filtRs, multithread = TRUE)
